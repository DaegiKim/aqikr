@(data: com.fasterxml.jackson.databind.JsonNode, stationName: String)
@import play.libs.Json;
@main("실시간 미세먼지 - AQIkr", null) {
    <div id="station-page">
        <div class="station-page-title">@stationName</div>
        <canvas id="myChart" height="100"></canvas>
        <table class="table">
            <thead>
                <tr>
                    <th>측정시간</th>
                    <th>초미세먼지</th>
                    <th>미세먼지</th>
                </tr>
            </thead>
            <tbody>
            @for(item <- data.get("list").elements()) {
                <tr>
                    <td>@item.get("timestamp").asText()</td>
                    <td>
                        <span style="background-color: @item.get("pm25Color").asText()">@item.get("pm25AQI").asInt()</span>
                        <span>(@item.get("pm25Value").asInt()µg/m³)</span>
                    </td>
                    <td>
                        <span style="background-color: @item.get("pm10Color").asText()">@item.get("pm10AQI").asInt()</span>
                        <span>(@item.get("pm10Value").asInt()µg/m³)</span>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>
    <script>
            var json = [];
            json = @Html(Json.stringify(data));
            json.list = json.list.reverse();

            var label_list = [];
            var data_list = [];
            var color_list = [];

            for (var i = 0; i < json.list.length; i++) {
                label_list.push(json.list[i].timestamp);
                data_list.push(parseInt(json.list[i].pm25AQI));
                color_list.push(json.list[i].pm25Color);
            }

            label_list = label_list.slice(label_list.length-(24*5));
            data_list = data_list.slice(data_list.length-(24*5));
            color_list = color_list.slice(color_list.length-(24*5));

            var data = {
                labels: label_list,
                datasets: [
                    {
                        label: "AQI PM2.5",
                        backgroundColor: color_list,
                        data: data_list
                    }
                ]
            };

            var ctx = document.getElementById("myChart");

            var myChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        xAxes: [{
                            type: 'time',
//                            time: {
//                                unit: 'week',
//                                displayFormats: {
//                                    hour: 'MMM D, hA'
//                                }
//                            }
                        }]
                    }
                }
            });
    </script>
}
